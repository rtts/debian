- name: Install graphical packages
  become: true
  apt:
    state: present
    name:
      - chromium
      - eog
      - evince
      - file-roller
      - filelight
      - firefox-esr
      - ghc
      - libghc-xmonad-contrib-dev
      - mpv
      - network-manager-gnome
      - paprefs
      - pavucontrol
      - pulseaudio
      - pulseaudio-module-zeroconf
      - rxvt-unicode
      - suckless-tools
      - thunar
      - trayer
      - webext-ublock-origin
      - x11-apps
      - x11-xserver-utils
      - xcalib
      - xclip
      - xfonts-jmk
      - xfonts-terminus
      - xinit
      - xinput
      - xmonad

- name: Setup autologin for user {{ ansible_user_id }}
  become: true
  template:
    src: override.conf
    dest: /etc/systemd/system/getty@tty1.service.d/

- name: Enable bitmap fonts
  become: true
  file:
    path: /usr/share/fontconfig/conf.avail/70-no-bitmaps.conf
    state: absent

- name: Configure Xsession
  become: true
  copy:
    src: Xsession.d/
    dest: /etc/X11/Xsession.d/

- name: Configure Xresources
  become: true
  copy:
    src: Xresources/
    dest: /etc/X11/Xresources/

- name: Configure Bash profile
  become: true
  copy:
    src: profile.d/
    dest: /etc/profile.d/

- name: Set default terminal emulator to rxvt-unicode
  become: true
  alternatives:
    name: x-terminal-emulator
    path: /usr/bin/urxvt

- name: Copy dotfiles
  become: true
  copy:
    src: dotfiles/
    dest: "{{ item.dest }}"
    owner: "{{ item.owner }}"
    force: "{{ item.force }}"
  loop:
    - dest: /home/{{ ansible_user_id }}/
      owner: "{{ ansible_user_id }}"
      force: false
    - dest: /etc/skel/
      owner: root
      force: true
